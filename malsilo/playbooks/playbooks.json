{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - MalSilo - 1.0.0",
      "description": "Sample playbooks for \"MalSilo\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "playbook_logo.png",
      "uuid": "dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get IP Feeds",
          "aliasName": null,
          "description": "Get IP Feeds from MalSilo",
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "tag": null,
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/f8dc9861-17b3-4bad-be45-23537a017f43",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get IP Feeds",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "config": "9cf5e6e3-31ab-40a6-bfd3-5a459b8a0eae",
                "params": [],
                "version": "1.0.0",
                "connector": "malsilo",
                "operation": "get_ipv4_feed",
                "operationTitle": "Get IPv4 Feeds",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "left": "193",
              "top": "135",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "a48d2563-bbd1-4c83-854d-31221aa3d32c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "79f6952c-32b3-4cf6-813b-ad7b8924a3c8",
                "title": "Get MalSilo IP Feeds",
                "resources": [
                  "indicators"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "left": "40",
              "top": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "f8dc9861-17b3-4bad-be45-23537a017f43"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "09eae1ba-f4c4-405c-b841-ec5afc732df8",
              "name": "Start -> Get IP Feeds",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/a48d2563-bbd1-4c83-854d-31221aa3d32c",
              "sourceStep": "/api/3/workflow_steps/f8dc9861-17b3-4bad-be45-23537a017f43"
            }
          ],
          "versions": null,
          "lastModifyDate": 1604992639,
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "03951cfc-57aa-4faf-a133-115ee61c98a3",
          "recordTags": [
            "malsilo"
          ],
          "isPrivate": false,
          "owners": []
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "MalSilo > Ingest",
          "aliasName": null,
          "description": "Data Ingestion Playbook",
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "tag": "#malsilo4 #dataIngestion #ingest",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/b0af6dd7-5aae-4680-b69e-f22ce15419dd",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": []
              },
              "status": null,
              "left": "33",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "b0af6dd7-5aae-4680-b69e-f22ce15419dd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/9634df50-4ed5-45f0-a9ed-ad578a1e6a55"
              },
              "status": null,
              "left": "200",
              "top": "111",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "60aba241-933c-43d6-80f1-1d37d06c9b89"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{ vars.steps.Fetch.data | batch(200) | list }}",
                  "condition": ""
                },
                "arguments": {
                  "threat_feeds": "{{ vars.item }}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/ef459fff-30b0-4de5-936a-21337b312e68"
              },
              "status": null,
              "left": "360",
              "top": "200",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "e16f404e-0b62-41c1-9648-21e4989321e9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.steps.Fetch.lastPullTimeMacro}}",
                  "value": "{{vars.steps.Fetch.lastPullTime}}"
                },
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "left": "532",
              "top": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "fe3b84f2-480d-44bf-9989-b8e04d769c78"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "7aff5925-267e-4d4e-9929-4ea778b1f355",
              "name": "Create -> Update Last Pull Time",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/fe3b84f2-480d-44bf-9989-b8e04d769c78",
              "sourceStep": "/api/3/workflow_steps/e16f404e-0b62-41c1-9648-21e4989321e9"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "ff71b3f2-27c6-49b4-bfa9-58e61170f55b",
              "name": "Start -> Fetch",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/60aba241-933c-43d6-80f1-1d37d06c9b89",
              "sourceStep": "/api/3/workflow_steps/b0af6dd7-5aae-4680-b69e-f22ce15419dd"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "4f05341a-3b8f-4fdf-8ead-4f62847e3aff",
              "name": "Fetch -> Create",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/e16f404e-0b62-41c1-9648-21e4989321e9",
              "sourceStep": "/api/3/workflow_steps/60aba241-933c-43d6-80f1-1d37d06c9b89"
            }
          ],
          "versions": null,
          "lastModifyDate": 1606400661,
          "priority": null,
          "uuid": "254deff6-13d0-4ef0-bdcc-9e38aa19521d",
          "recordTags": [
            "dataingestion",
            "ingest",
            "malsilo"
          ],
          "isPrivate": false,
          "owners": []
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">>MalSilo > Init Macros",
          "aliasName": null,
          "description": "Data Ingestion Playbook",
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "tag": "#malsilo #dataingestion",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "overrideIfNoMatch",
            "macroName",
            "macroValue"
          ],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/91972b4f-0a56-47c0-b977-6753f4ea20e9",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch Macro Current Value",
              "description": null,
              "arguments": {
                "macroExistingRecord": "{{vars.steps.Get_Macro.data['hydra:member'][0]}}"
              },
              "status": null,
              "left": "580",
              "top": "380",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "6a7938a2-c487-47eb-b625-e19253fdc2d3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Macro Exists",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Does Not Exist",
                    "step_iri": "/api/3/workflow_steps/7fc65cdd-7928-401e-b490-9899796a37ba",
                    "condition": "{{ vars.steps.Get_Macro.data['hydra:totalItems']==0 }}",
                    "step_name": "Create ServiceNow Macro"
                  },
                  {
                    "option": "Exists",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/6a7938a2-c487-47eb-b625-e19253fdc2d3",
                    "step_name": "Fetch Macro Current Value"
                  }
                ]
              },
              "status": null,
              "left": "380",
              "top": "280",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "1e2a864e-aa13-4b48-8cfe-f1606d4eca1f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Marco If Required",
              "description": null,
              "arguments": {
                "when": "{{(vars.overrideIfNoMatch  == true) and (vars.macroExistingRecord.value != vars.macroValue)}}",
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/{{ vars.macroExistingRecord.id }}/",
                  "body": "{ 'name': '{{vars.macroName}}'   , 'value': '{{vars.macroValue}}' }",
                  "method": "PUT"
                },
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "left": "580",
              "top": "520",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "9dbb7cb0-57f7-4904-b177-d80c03afe88a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "macroName": "{{ vars.macroName }}",
                      "macroValue": "{{ vars.macroValue }}",
                      "overrideIfNoMatch": "{{ vars.overrideIfNoMatch }}",
                      "ServiceNowMacroName": "{{ vars.ServiceNowMacroName }}",
                      "ServiceNowMacroValue": "{{ vars.ServiceNowMacroValue }}"
                    }
                  }
                }
              },
              "status": null,
              "left": "380",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "91972b4f-0a56-47c0-b977-6753f4ea20e9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Macro",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json",
                  "body": "{ 'name': '{{vars.macroName}}'   , 'value': '{{vars.macroValue}}' }",
                  "method": "POST"
                },
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "left": "180",
              "top": "375",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "7fc65cdd-7928-401e-b490-9899796a37ba"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.macroName}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "left": "380",
              "top": "153",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "29c5eeb6-d70a-4660-8551-d934eb63d9ab"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "017ba23a-4940-4cf6-9a8e-8dc15d77db99",
              "name": "Get ServiceNow Macros -> ServiceNow Macro Exists",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/1e2a864e-aa13-4b48-8cfe-f1606d4eca1f",
              "sourceStep": "/api/3/workflow_steps/29c5eeb6-d70a-4660-8551-d934eb63d9ab"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "9d989416-8b8c-48ca-a28c-a1cdabe709d1",
              "name": "Start -> Get ServiceNow Macros",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/29c5eeb6-d70a-4660-8551-d934eb63d9ab",
              "sourceStep": "/api/3/workflow_steps/91972b4f-0a56-47c0-b977-6753f4ea20e9"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "62b0e52d-7bc2-42c2-8a00-c48a9fa16b98",
              "name": "Fetch Macro Current Value -> Update Marco If Required",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/9dbb7cb0-57f7-4904-b177-d80c03afe88a",
              "sourceStep": "/api/3/workflow_steps/6a7938a2-c487-47eb-b625-e19253fdc2d3"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "d998bf7f-ad2d-4f30-8e92-2f08d8a0b854",
              "name": "ServiceNow Macro Exists -> Create ServiceNow Macro",
              "label": "Does Not Exist",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/7fc65cdd-7928-401e-b490-9899796a37ba",
              "sourceStep": "/api/3/workflow_steps/1e2a864e-aa13-4b48-8cfe-f1606d4eca1f"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "fb09c6a2-8009-4036-9707-da784f33a6e6",
              "name": "ServiceNow Macro Exists -> Fetch Macro Current Value",
              "label": "Exists",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/6a7938a2-c487-47eb-b625-e19253fdc2d3",
              "sourceStep": "/api/3/workflow_steps/1e2a864e-aa13-4b48-8cfe-f1606d4eca1f"
            }
          ],
          "versions": null,
          "lastModifyDate": 1606400649,
          "priority": null,
          "uuid": "3438e177-06af-4470-b60e-d31ce72a311f",
          "recordTags": [
            "dataingestion",
            "malsilo"
          ],
          "isPrivate": false,
          "owners": []
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> MalSilo > Fetch",
          "aliasName": null,
          "description": "Data Ingestion Playbook",
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "tag": "#malsilo #dataingestion #fetch",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/d29b8219-0763-4171-9d44-6a66d35d67fd",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "fetchTime": "{{arrow.utcnow().timestamp}}",
                "macroNameForLastPullTime": "MalSiloLastPullTime"
              },
              "status": null,
              "left": "151",
              "top": "140",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "bcced530-f04c-415f-a766-651c5e1f91ec"
            },
            {
              "@type": "WorkflowStep",
              "name": "Environment Setup",
              "description": null,
              "arguments": {
                "when": "{{vars.request.env_setup}}",
                "arguments": {
                  "macroName": "{{vars.macroNameForLastPullTime}}",
                  "macroValue": "0",
                  "overrideIfNoMatch": "false"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3438e177-06af-4470-b60e-d31ce72a311f"
              },
              "status": null,
              "left": "300",
              "top": "260",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "81899b5e-84c9-497a-b9b0-2279285cc917"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "_configuration_schema": "[\n  {\n    \"title\": \"Type of feeds to ingest\",\n    \"name\": \"feedtypes\",\n    \"type\": \"multiselect\",\n    \"tooltip\": \"Select one or more types you want to pull from the MalSilo feeds list\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\n      \"IP\",\n      \"Domain\",\n      \"URL\"\n    ],\n    \"options\": [\"IP\", \"Domain\", \"URL\"],\n    \"value\": [\"IP\", \"Domain\", \"URL\"]\n  }\n]"
                }
              },
              "status": null,
              "left": "0",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "d29b8219-0763-4171-9d44-6a66d35d67fd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Take samples of all types",
              "description": "For mapping in the ingestion wizard, we need not have all the data. 5 samples of all types - ip, domain, url should be sufficient",
              "arguments": {
                "data": "{{ (vars.ipFeeds.feed | json_query('[:5]')) | union(vars.urlFeeds.feed | json_query('[:5]')) | union(vars.domainFeeds.feed | json_query('[:5]'))}}",
                "lastPullTime": "{{vars.fetchTime}}",
                "lastPullTimeMacro": "{{vars.macroNameForLastPullTime}}"
              },
              "status": null,
              "left": "1580",
              "top": "140",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "33daec82-c55c-4c1d-a066-eaafe2d50443"
            },
            {
              "@type": "WorkflowStep",
              "name": "Collect all data newer than last pull time",
              "description": null,
              "arguments": {
                "data": "{% set _new_feeds=[] %}\n{% if vars.ipFeeds.generatedAt > vars.lastSuccessPullTime %}\n{% set _temp=_new_feeds.extend(vars.ipFeeds.feed) %}\n{% endif %}\n{% if vars.urlFeeds.generatedAt > vars.lastSuccessPullTime %}\n{% set _temp=_new_feeds.extend(vars.urlFeeds.feed) %}\n{% endif %}\n{% if vars.domainFeeds.generatedAt > vars.lastSuccessPullTime %}\n{% set _temp=_new_feeds.extend(vars.domainFeeds.feed) %}\n{% endif %}\n{{ _new_feeds }}",
                "lastPullTime": "{{vars.fetchTime}}",
                "lastPullTimeMacro": "{{vars.macroNameForLastPullTime}}"
              },
              "status": null,
              "left": "1891",
              "top": "420",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "3bbf1071-795b-4e8e-a4a1-8f6d7214d6da"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Last Successfull Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.macroNameForLastPullTime}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.0.4",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": {
                  "lastSuccessPullTime": "{{vars.result.data['hydra:member'][0].value}}"
                }
              },
              "status": null,
              "left": "1580",
              "top": "420",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "0f3abcb0-014e-4d6b-be8c-1be45f89743f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch IPv4",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "when": "{{\"IP\" in vars.feedtypes}}",
                "config": "0c8a5021-d608-4cad-8af3-c30962e8a095",
                "params": [],
                "version": "1.0.0",
                "connector": "malsilo",
                "operation": "get_ipv4_feed",
                "operationTitle": "Get IPv4 Feeds",
                "pickFromTenant": false,
                "step_variables": {
                  "ipFeeds": "{{vars.result.data}}"
                }
              },
              "status": null,
              "left": "600",
              "top": "160",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "6949656e-b94a-4d0d-8757-cda74d044bae"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Domain",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "when": "{{\"Domain\" in vars.feedtypes}}",
                "config": "0c8a5021-d608-4cad-8af3-c30962e8a095",
                "params": [],
                "version": "1.0.0",
                "connector": "malsilo",
                "operation": "get_domain_feed",
                "operationTitle": "Get Domain Feeds",
                "pickFromTenant": false,
                "step_variables": {
                  "domainFeeds": "{{vars.result.data}}"
                }
              },
              "status": null,
              "left": "600",
              "top": "260",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "65496130-c9cc-42fb-a447-38598b8070e4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Do we need data only for mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, field mapping only",
                    "step_iri": "/api/3/workflow_steps/33daec82-c55c-4c1d-a066-eaafe2d50443",
                    "condition": "{{ 'env_setup' in vars.request and vars.request.env_setup }}",
                    "step_name": "Take samples of all types"
                  },
                  {
                    "option": "No, for ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/0f3abcb0-014e-4d6b-be8c-1be45f89743f",
                    "step_name": "Get Last Successfull Pull Time"
                  }
                ]
              },
              "status": null,
              "left": "1225",
              "top": "260",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "1539f637-e2b8-4aa2-8b94-bed35599d2da"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch URL",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "when": "{{\"URL\" in vars.feedtypes}}",
                "config": "0c8a5021-d608-4cad-8af3-c30962e8a095",
                "params": [],
                "version": "1.0.0",
                "connector": "malsilo",
                "operation": "get_url_feed",
                "operationTitle": "Get URL Feeds",
                "pickFromTenant": false,
                "step_variables": {
                  "urlFeeds": "{{vars.result.data}}"
                }
              },
              "status": null,
              "left": "600",
              "top": "360",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b59ed053-0017-4a09-b81b-30c637ee36d3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Collect Feeds Lists",
              "description": null,
              "arguments": {
                "ipFeeds": "{% if \"IP\" in vars.feedtypes %}{{vars.steps.Fetch_IPv4.data}}{% else %}{\"feed\": [], \"generatedAt\": 0}{% endif %}",
                "urlFeeds": "{% if \"URL\" in vars.feedtypes %}{{vars.steps.Fetch_URL.data}}{% else %}{\"feed\": [], \"generatedAt\": 0}{% endif %}",
                "domainFeeds": "{% if \"Domain\" in vars.feedtypes %}{{vars.steps.Fetch_Domain.data}}{% else %}{\"feed\": [], \"generatedAt\": 0}{% endif %}"
              },
              "status": null,
              "left": "940",
              "top": "260",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "09b015f7-bebe-46f6-bb67-08ffeaa1d7fc"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "9f755ec5-fff6-4469-99ef-d861990aef44",
              "name": "Start -> Configuration",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/bcced530-f04c-415f-a766-651c5e1f91ec",
              "sourceStep": "/api/3/workflow_steps/d29b8219-0763-4171-9d44-6a66d35d67fd"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "c91979c0-aac1-4351-92e4-2698973a2d85",
              "name": "Configuration -> Environment Setup",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/81899b5e-84c9-497a-b9b0-2279285cc917",
              "sourceStep": "/api/3/workflow_steps/bcced530-f04c-415f-a766-651c5e1f91ec"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "b0f371c5-b8c2-451c-a4da-ea8b350cc08d",
              "name": "Environment Setup -> Fetch IPv4",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/6949656e-b94a-4d0d-8757-cda74d044bae",
              "sourceStep": "/api/3/workflow_steps/81899b5e-84c9-497a-b9b0-2279285cc917"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "12a5448f-6dc2-4334-9326-1191dfcb9c4a",
              "name": "Environment Setup -> Copy  of Fetch IPv4",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/65496130-c9cc-42fb-a447-38598b8070e4",
              "sourceStep": "/api/3/workflow_steps/81899b5e-84c9-497a-b9b0-2279285cc917"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "1e2f1d54-0e39-4b99-98df-9d41d9859534",
              "name": "Environment Setup -> Copy 1 of Fetch IPv4",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/b59ed053-0017-4a09-b81b-30c637ee36d3",
              "sourceStep": "/api/3/workflow_steps/81899b5e-84c9-497a-b9b0-2279285cc917"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "da967b90-e6db-4362-ba2d-154f7ef7b692",
              "name": "Do we need data only for mapping -> Take samples of all types",
              "label": "Yes, field mapping only",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/33daec82-c55c-4c1d-a066-eaafe2d50443",
              "sourceStep": "/api/3/workflow_steps/1539f637-e2b8-4aa2-8b94-bed35599d2da"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "3dd84bc3-0ce4-4e57-94fc-f39eb1421290",
              "name": "Do we need data only for mapping -> Copy  of Get Last Successfull Pull Time",
              "label": "No, for ingestion",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/0f3abcb0-014e-4d6b-be8c-1be45f89743f",
              "sourceStep": "/api/3/workflow_steps/1539f637-e2b8-4aa2-8b94-bed35599d2da"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "5eb973a1-94b7-41fb-b228-fa6362734829",
              "name": "Get Last Successfull Pull Time -> Collect all data newer than last pull time",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/3bbf1071-795b-4e8e-a4a1-8f6d7214d6da",
              "sourceStep": "/api/3/workflow_steps/0f3abcb0-014e-4d6b-be8c-1be45f89743f"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "eba083f6-e840-4aa8-b3ed-18a4f4955ef6",
              "name": "Fetch IPv4 -> Copy  of Configuration",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/09b015f7-bebe-46f6-bb67-08ffeaa1d7fc",
              "sourceStep": "/api/3/workflow_steps/6949656e-b94a-4d0d-8757-cda74d044bae"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "3c96cc59-ae7d-4554-8acc-1c087bda2161",
              "name": "Fetch Domain -> Copy  of Configuration",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/09b015f7-bebe-46f6-bb67-08ffeaa1d7fc",
              "sourceStep": "/api/3/workflow_steps/65496130-c9cc-42fb-a447-38598b8070e4"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "671b1ca3-bcd7-405c-a3f5-ee2ef4156a88",
              "name": "Fetch URL -> Copy  of Configuration",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/09b015f7-bebe-46f6-bb67-08ffeaa1d7fc",
              "sourceStep": "/api/3/workflow_steps/b59ed053-0017-4a09-b81b-30c637ee36d3"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "3c783260-1666-4f51-a9fe-d525ec294582",
              "name": "Copy  of Configuration -> Do we need data only for mapping",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/1539f637-e2b8-4aa2-8b94-bed35599d2da",
              "sourceStep": "/api/3/workflow_steps/09b015f7-bebe-46f6-bb67-08ffeaa1d7fc"
            }
          ],
          "versions": null,
          "lastModifyDate": 1606400984,
          "priority": null,
          "uuid": "9634df50-4ed5-45f0-a9ed-ad578a1e6a55",
          "recordTags": [
            "dataingestion",
            "fetch",
            "malsilo"
          ],
          "isPrivate": false,
          "owners": []
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Domain Feeds",
          "aliasName": null,
          "description": "Get Domain Feeds from MalSilo",
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "tag": null,
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/7e63f6ca-f03b-4843-ae0c-6dde01b3991d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "d1a6e7aa-5759-431c-9f4e-63a6f9d71e46",
                "title": "Get MalSilo Domain Feeds",
                "resources": [
                  "indicators"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "left": "40",
              "top": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "7e63f6ca-f03b-4843-ae0c-6dde01b3991d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Domain Feeds",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "config": "9cf5e6e3-31ab-40a6-bfd3-5a459b8a0eae",
                "params": [],
                "version": "1.0.0",
                "connector": "malsilo",
                "operation": "get_domain_feed",
                "operationTitle": "Get Domain Feeds",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "left": "193",
              "top": "135",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "9697d1de-e783-4069-a699-360439422071"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "eeb90c17-95ba-471a-8ee2-9e2aad629a67",
              "name": "Start -> Get IP Feeds",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/9697d1de-e783-4069-a699-360439422071",
              "sourceStep": "/api/3/workflow_steps/7e63f6ca-f03b-4843-ae0c-6dde01b3991d"
            }
          ],
          "versions": null,
          "lastModifyDate": 1604992717,
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "ba94256a-34ac-4b3e-8438-325656ee2443",
          "recordTags": [
            "malsilo"
          ],
          "isPrivate": false,
          "owners": []
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> MalSilo > Create",
          "aliasName": null,
          "description": "Data Ingestion Playbook",
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "tag": "#malsilo #dataingestion #create",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "threat_feeds"
          ],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/b68bd691-7ecf-4507-9f54-8c993e7a4581",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": []
              },
              "status": null,
              "left": "125",
              "top": "30",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "b68bd691-7ecf-4507-9f54-8c993e7a4581"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "indicators_reputation_map": "{}",
                "indicators_indicatorStatus_map": "{}",
                "indicators_typeofindicator_map": "{'domain': {{'IndicatorType'| picklist('Domain') }}, 'ipv4': {{'IndicatorType'| picklist('IP Address') }}, 'url': {{'IndicatorType'| picklist('URL') }}}"
              },
              "status": null,
              "left": "125",
              "top": "165",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "252bacab-2487-4dfd-9af0-8d7b29862e93"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.input.params['threat_feeds']}}",
                  "__bulk": true,
                  "condition": ""
                },
                "resource": {
                  "value": "{% if vars.item.type==\"ipv4\" %}{{ vars.item['value'] | regex_replace(\":[0-9]*\", \"\")}}{% else %}{{ vars.item['value'] }}{% endif %}",
                  "__link": {
                    "recordTags": "{{vars.item.tags}}"
                  },
                  "sources": "MalSilo",
                  "lastSeen": "{{ arrow.get(vars.item.Lastseen, 'YYYY-MM-DD').timestamp }}",
                  "__replace": "true",
                  "firstSeen": "{{ arrow.get(vars.item.Firstseen, 'YYYY-MM-DD').timestamp }}",
                  "reputation": {
                    "id": 73,
                    "@id": "/api/3/picklists/50bfd06c-9aff-4f7d-b6d9-821339e31fe7",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#dbc030",
                    "display": "Suspicious",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "Suspicious",
                    "orderIndex": 2
                  },
                  "description": "Threat: {{vars.item.threat}}\nTags: {{vars.item.tags}}\nValue:  {{vars.item[\"value\"] }}",
                  "indicatorStatus": {
                    "id": 369,
                    "@id": "/api/3/picklists/2f5cff61-fbff-4bb3-96be-302b78a9fb47",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "TBD",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/e6639d57-94a9-432f-a46f-b2b530402077",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "typeofindicator": "{{vars.item[\"type\"] | resolveRange(vars.indicators_typeofindicator_map)}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "left": "125",
              "top": "300",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "a462022e-7cde-43b8-95cf-cf7c02178145"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "616c8708-0557-4a68-a194-0510bb6564a6",
              "name": "Start -> Configuration",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/252bacab-2487-4dfd-9af0-8d7b29862e93",
              "sourceStep": "/api/3/workflow_steps/b68bd691-7ecf-4507-9f54-8c993e7a4581"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "52b2f59f-3b7f-44a7-b269-2fa1efaca87e",
              "name": "Configuration -> Create Record",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/a462022e-7cde-43b8-95cf-cf7c02178145",
              "sourceStep": "/api/3/workflow_steps/252bacab-2487-4dfd-9af0-8d7b29862e93"
            }
          ],
          "versions": null,
          "lastModifyDate": 1606400999,
          "priority": null,
          "uuid": "ef459fff-30b0-4de5-936a-21337b312e68",
          "recordTags": [
            "dataingestion",
            "create",
            "malsilo"
          ],
          "isPrivate": false,
          "owners": []
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get URL Feeds",
          "aliasName": null,
          "description": "Get URL Feeds from MalSilo",
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "tag": null,
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/1959341e-86e1-4d6a-be2f-608bed7c5997",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "37170180-a7dc-4f44-9c9a-96aa85b6a5ac",
                "title": "Get MalSilo URL Feeds",
                "resources": [
                  "indicators"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "left": "40",
              "top": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "1959341e-86e1-4d6a-be2f-608bed7c5997"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get URL Feeds",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "config": "9cf5e6e3-31ab-40a6-bfd3-5a459b8a0eae",
                "params": [],
                "version": "1.0.0",
                "connector": "malsilo",
                "operation": "get_url_feed",
                "operationTitle": "Get URL Feeds",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "left": "193",
              "top": "135",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "8ab7a8c3-7dd1-45d0-bd67-d1ec6257038d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "24486673-8744-41bd-ae92-53f96f767e73",
              "name": "Start -> Get IP Feeds",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/8ab7a8c3-7dd1-45d0-bd67-d1ec6257038d",
              "sourceStep": "/api/3/workflow_steps/1959341e-86e1-4d6a-be2f-608bed7c5997"
            }
          ],
          "versions": null,
          "lastModifyDate": 1604992734,
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "f47c94de-e2fa-4347-b857-1a25a961b5b7",
          "recordTags": [
            "malsilo"
          ],
          "isPrivate": false,
          "owners": []
        }
      ]
    }
  ],
  "exported_tags": [
    "malsilo",
    "dataingestion",
    "ingest",
    "fetch",
    "create"
  ]
}